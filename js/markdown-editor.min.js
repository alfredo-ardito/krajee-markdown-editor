/*!
 * krajee-markdown-editor v1.0.0
 * http://plugins.krajee.com/krajee-markdown-editor
 *
 * Krajee Markdown Editor Main Plugin Library
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2018, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD 3-Clause
 * https://github.com/kartik-v/krajee-markdown-editor/blob/master/LICENSE.md
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";var t,n,i,o,a,s,r;e.fn.markdownEditorLocales={},e.fn.markdownEditorThemes={},t={CREDITS:'<a class="text-info" href="http://plugins.krajee.com/markdown-editor">krajee-markdown-editor</a>',CREDITS_MD:"[krajee-markdown-editor](http://plugins.krajee.com/markdown-editor)",BS4_VER:"4.1.1",BS3_VER:"3.3.7",DEFAULT_TIMEOUT:250,EMPTY:"",NAMESPACE:".markdownEditor",LINK_CM:'<a href="http://spec.commonmark.org/" target="_blank">CommonMark</a>',LINK_MI:'<a href="https://markdown-it.github.io/markdown-it/" target="_blank">markdown-it</a>',htmlEncode:function(e){return void 0===e?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},parseHtml:function(e){return void 0===e?"":t.kvUnescape(encodeURIComponent(e))},create:function(n,i){var o=e(document.createElement(n));return t.isEmpty(i)||o.attr(i),o},addCss:function(e,t){t&&e.removeClass(t).addClass(t)},uniqueId:function(){return Math.round((new Date).getTime()+100*Math.random())},isEmpty:function(n,i){return null==n||0===n.length||i&&e.trim(n)===t.EMPTY},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},trimRight:function(e,t){return void 0===t&&(t="s"),e.replace(new RegExp("["+t+"]+$"),"")},getMarkUp:function(e,t,n,i){var o,a,s,r=t.length,l=n.length,d=e,c="",u="",h=!1;return i&&(d=e.replace(/^\s+|\s+$/g,""))!==e&&(h=!0),r>0&&(d=d.slice(0,r)===t?d.slice(r):t+d),l>0&&(d=d.slice(-l)===n?d.slice(0,-l):d+n),h&&(c=e.replace(/^\s+/,""),u=e.replace(/\s+$/,""),o=(s=e.length)-c.length,a=u.length,o>0&&(d=e.substring(0,o)+d),a>0&&(d+=e.substring(a,s))),d},getBlockMarkUp:function(n,i,o,a){var s=n,r=[];return s.indexOf("\n")<0?s=t.getMarkUp(n,i,o,a):(r=n.split("\n"),e.each(r,function(e,n){r[e]=t.getMarkUp(t.trimRight(n),i,o+"  ",a)}),s=r.join("\n")),s},setWhitespace:function(e,t){try{e.style.whiteSpace=t}catch(e){}},setSelectionRange:function(n,i,o){var a,s;if(n.setSelectionRange)n.focus(),n.setSelectionRange(i,o),n.scrollTop=0,i>100&&(a=document.createElement("pre"),n.parentNode.appendChild(a),s=window.getComputedStyle(n,""),a.style={visibility:"hidden",lineHeight:s.lineHeight,fontFamily:s.fontFamily,fontSize:s.fontSize,padding:0,border:s.border,outline:s.outline,overflow:"scroll",letterSpacing:s.letterSpacing},t.setWhitespace(a,"-moz-pre-wrap"),t.setWhitespace(a,"-o-pre-wrap"),t.setWhitespace(a,"-pre-wrap"),t.setWhitespace(a,"pre-wrap"),a.textContent=e(n).val().substring(0,i-100),n.scrollTop=a.scrollHeight,a.parentNode.removeChild(a));else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0),r.moveEnd("character",o),r.moveStart("character",i),r.select()}},kvUnescape:function(e){return e.replace(/%([0-9A-F]{2})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})},handler:function(e,t){e&&e.isDefaultPrevented()||t()},delay:(r=0,function(e,n){clearTimeout(r),r=setTimeout(e,n||t.DEFAULT_TIMEOUT)})},n={click:"click"+t.NAMESPACE,input:"input"+t.NAMESPACE,change:"change"+t.NAMESPACE,focus:"focus"+t.NAMESPACE,blur:"blur"+t.NAMESPACE,keyup:"keyup"+t.NAMESPACE,keydown:"keydown"+t.NAMESPACE,resize:"resize"+t.NAMESPACE,reset:"reset"+t.NAMESPACE,scroll:"scroll"+t.NAMESPACE,touchstart:"touchstart"+t.NAMESPACE,mouseover:"mouseover"+t.NAMESPACE,modalShown:"shown.bs.modal"+t.NAMESPACE,modalHidden:"hidden.bs.modal"+t.NAMESPACE,buttonPress:"buttonPress"+t.NAMESPACE,beforePreview:"beforePreview"+t.NAMESPACE,successPreview:"successPreview"+t.NAMESPACE,emptyPreview:"emptyPreview"+t.NAMESPACE,errorPreview:"errorPreview"+t.NAMESPACE},i={toolbar:{toolbarHeaderL:[["undo","redo"],["bold","italic","ins","del","sup","sub","mark"],["paragraph","newline","heading"],["link","image"],["indent","outdent","ul","ol","dl"],["footnote","blockquote","hr"],["code","codeblock"],["emoji"]],toolbarHeaderR:[["fullscreen"]],toolbarFooterL:[["hint"],["export"]],toolbarFooterR:[["mode"]]},templates:{main:'<div class="md-editor" tabindex="0">\n  {HEADER}\n  <table class="md-input-preview">\n    <tr>\n      <td class="md-input-cell">{INPUT}</td>\n      <td class="md-preview-cell">{PREVIEW}</td>\n    </tr>  </table>\n  {FOOTER}\n  {DIALOG}\n</div>',header:'<div class="md-header">\n  <div class="md-toolbar-header-r pull-right float-right">\n    {TOOLBAR_HEADER_R}\n  </div>\n  <div class="md-toolbar-header-l">\n    {TOOLBAR_HEADER_L}\n  </div>\n  <div class="clearfix">\n  </div>\n</div>',preview:'<div class="md-preview" tabindex="0">\n</div>',footer:'<div class="md-footer">\n  <div class="md-toolbar-footer-r pull-right float-right">\n    {TOOLBAR_FOOTER_R}\n  </div>\n  <div class="md-toolbar-footer-l">\n    {TOOLBAR_FOOTER_L}\n  </div>\n  <div class="clearfix">\n  </div>\n</div>',dialog:'<div class="md-dialog modal fade" tabindex="-1" role="dialog">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n         {HEADER}\n      </div>\n      <div class="modal-body">\n        <input class="md-dialog-input form-control">\n        <input class="md-dialog-title form-control">\n        <div class="md-dialog-content"></div>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="md-dialog-cancel btn btn-default btn-outline-secondary" data-dismiss="modal">\n          {DIALOG_CANCEL_ICON} {DIALOG_CANCEL_TEXT}\n        </button>\n        <button type="button" class="md-dialog-submit btn btn-primary" data-dismiss="modal">\n          {DIALOG_SUBMIT_ICON} {DIALOG_SUBMIT_TEXT}\n        </button>\n      </div>\n    </div>\n</div>',dialogClose:'<button type="button" class="close" data-dismiss="modal" aria-label="Close">\n  <span aria-hidden="true">&times;</span>\n</button>\n',htmlMeta:'<!DOCTYPE html>\n  <meta http-equiv="Content-Type" content="text/html,charset=UTF-8"/>\n  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>\n',exportCssJs:"{EXPORT_PREPEND_CSS_JS}\n<style>\n  body{margin:20px;padding:20px;border:1px solid #ddd;border-radius:5px;}\n  .md-codeblock{padding:5px 8px;background-color:#f5f5f5;border:1px solid #ddd;border-radius:0}\n  .md-blockquote{border-left:5px solid #eee;padding: 10px 20px}\n  .md-line img{max-width:100%}\n</style>",exportHeader:"> - - -\n> Markdown Export\n> ==============\n> *Generated {TODAY} by {CREDITS}*\n> - - -\n\n",hint:"<ul>\n  <li><p>You may follow the {LINK_CM} specification (generated via {LINK_MI} plugin) for writing your markdown text.</p></li>\n  <li><p>In order to use the formatting buttons on the toolbar, you generally need to highlight a text   within the editor on which the formatting is to be applied. You can also undo the format action on the   highlighted text by clicking the button again (for most buttons).</p></li>\n  <li><p>Keyboard access shortcuts for buttons:</p>    {ACCESS_KEYS}  </li>\n</ul>"},icons:{undo:'<span class="fas fa-fw fa-undo"></span>',redo:'<span class="fas fa-fw fa-redo"></span>',bold:'<span class="fas fa-fw fa-bold"></span>',italic:'<span class="fas fa-fw fa-italic"></span>',ins:'<span class="fas fa-fw fa-underline"></span>',del:'<span class="fas fa-fw fa-strikethrough"></span>',sup:'<span class="fas fa-fw fa-superscript"></span>',sub:'<span class="fas fa-fw fa-subscript"></span>',mark:'<span class="fas fa-fw fa-eraser"></span>',paragraph:'<span class="fas fa-fw fa-paragraph"></span>',newline:'<span class="fas fa-fw fa-text-height"></span>',heading:'<span class="fas fa-fw fa-heading"></span>',link:'<span class="fas fa-fw fa-link"></span>',image:'<span class="far fa-fw fa-image"></span>',indent:'<span class="fas fa-fw fa-indent"></span>',outdent:'<span class="fas fa-fw fa-outdent"></span>',ul:'<span class="fas fa-fw fa-list-ul"></span>',ol:'<span class="fas fa-fw fa-list-ol"></span>',dl:'<span class="fas fa-fw fa-th-list"></span>',footnote:'<span class="far fa-fw fa-sticky-note"></span>',blockquote:'<span class="fas fa-fw fa-quote-right"></span>',code:'<span class="fas fa-fw fa-code"></span>',codeblock:'<span class="far fa-fw fa-file-code"></span>',hr:'<span class="fas fa-fw fa-minus"></span>',emoji:'<span class="far fa-fw fa-smile"></span>',fullscreen:'<span class="fas fa-fw fa-arrows-alt"></span>',minscreen:'<span class="fas fa-fw fa-compress"></span>',hint:'<span class="fas fa-fw fa-lightbulb"></span>',modePreview:'<span class="fas fa-fw fa-search"></span>',modeEditor:'<span class="fas fa-fw fa-edit"></span>',modeSplit:'<span class="fas fa-fw fa-arrows-alt-h"></span>',export:'<span class="fas fa-fw fa-download"></span>',exportHtml:'<span class="fas fa-fw fa-file-alt"></span>',exportText:'<span class="fas fa-fw fa-file"></span>',alertMsg:'<span class="fas fa-fw fa-exclamation-circle"></span>',dialogCancel:'<span class="fas fa-fw fa-times"></span>',dialogSubmit:'<span class="fas fa-fw fa-check"></span>'},buttonAccessKeys:{undo:"z",redo:"y",bold:"b",italic:"i",ins:"u",del:"x",sup:"^",sub:"~",mark:"=",paragraph:"#",newline:"0",heading1:"1",heading2:"2",heading3:"3",heading4:"4",heading5:"5",heading6:"6",link:"l",image:"p",indent:">",outdent:"<",ul:"*",ol:"9",dl:"+",footnote:"n",blockquote:"q",code:"j",codeblock:"k",hr:"-",emoji:":",fullscreen:".",hint:"?",modeEditor:"(",modePreview:")",modeSplit:"_",exportHtml:"h",exportText:"t"},buttonTitles:{undo:"Undo",redo:"Redo",bold:"Bold",italic:"Italic",ins:"Underline / Inserted Text",del:"Strike Through",sup:"Superscript",sub:"Subscript",mark:"Highlighted Text",paragraph:"Paragraph",newline:"Append line break",heading:"Heading",link:"Hyperlink",image:"Image Link",indent:"Indent Text",outdent:"Outdent Text",ul:"Unordered List",ol:"Ordered List",dl:"Definition List",footnote:"Footnote",blockquote:"Block Quote",code:"Inline Code",codeblock:"Code Block",hr:"Horizontal Line",emoji:"Emojis / Emoticons",fullscreen:"Toggle full screen mode",hint:"Usage Hints",modeEditor:"Editor mode",modePreview:"Preview mode",modeSplit:"Split mode",export:"Export content",exportHtml:"Export as HTML",exportText:"Export as Text"},buttonCss:{hint:"btn btn-info"},dropdownCss:{emoji:"md-emojies-list pull-right float-right"},buttonLabels:{export:"Export",exportHtml:"HTML",exportText:"Text"},buttonPrompts:{link:{header:"Insert Hyperlink",hintInput:"Enter hyperlink address...",hintTitle:"Enter text for the link..."},image:{header:"Insert Image Link",hintInput:"Enter image link address...",hintTitle:"Enter alternate text for the image..."},ol:{header:"Ordered List Starting Number",hintInput:"Integer starting from 1"},codeblock:{header:"Enter code language",hintInput:"e.g. html, php, js"}},buttonActions:{bold:{before:"**",after:"**",default:"**(bold text here)**",skipSpaces:!0},italic:{before:"_",after:"_",default:"_(italic text here)_",skipSpaces:!0},ins:{before:"++",after:"++",default:"_(inserted text here)_",skipSpaces:!0},del:{before:"~~",after:"~~",default:"_(strikethrough text here)_",skipSpaces:!0},mark:{before:"==",after:"==",default:"_(marked text here)_",skipSpaces:!0},sup:{before:"^",after:"^",default:"_(superscript text here)_",skipSpaces:!0},sub:{before:"~",after:"~",default:"_(subscript text here)_",skipSpaces:!0},paragraph:{before:"\n",after:"\n",default:"\n(paragraph text here)\n",inline:!0},newline:{before:t.EMPTY,after:"  "},heading1:{before:"# ",default:"# (heading 1 text here)",inline:!0},heading2:{before:"## ",default:"## (heading 2 text here)",inline:!0},heading3:{before:"### ",default:"### (heading 3 text here)",inline:!0},heading4:{before:"#### ",default:"#### (heading 4 text here)",inline:!0},heading5:{before:"##### ",default:"##### (heading 5 text here)",inline:!0},heading6:{before:"###### ",default:"###### (heading 6 text here)",inline:!0},indent:function(t){var n;return t.indexOf("\n")<0?t="  "+t:(n=t.split("\n"),e.each(n,function(e,t){n[e]="  "+t}),t=n.join("\n")),t},outdent:function(t){var n;return t.indexOf("\n")<0&&"  "===t.substr(0,2)?t=t.slice(2):(n=t.split("\n"),e.each(n,function(e,t){n[e]=t,"  "===t.substr(0,2)&&(n[e]=t.slice(2))}),t=n.join("\n")),t},link:function(e){return function(n,i){return t.isEmpty(n)||("ftp://"!==n.substring(0,6)&&"http://"!==n.substring(0,7)&&"https://"!==n.substring(0,8)&&(n="http://"+n),e="["+i+"]("+n+")"),e}},image:function(e){return function(n,i){return t.isEmpty(n)||("ftp://"!==n.substring(0,6)&&"http://"!==n.substring(0,7)&&"https://"!==n.substring(0,8)&&(n="http://"+n),e="!["+i+"]("+n+")"),e}},ul:{before:"- ",after:t.EMPTY},ol:function(n){var i,o;return function(a){return t.isEmpty(a)?t.EMPTY:(t.isNumber(a)||(a=1),n.indexOf("\n")<0?n=t.getMarkUp(n,a+". ",t.EMPTY):(i=parseInt(a),o=n.split("\n"),e.each(o,function(e,n){o[e]=t.getMarkUp(n,i+". ",t.EMPTY),i++}),n=o.join("\n")),n)}},dl:function(n){var i,o,a;return n.indexOf("\n")>0?(i=1,a=n.split("\n"),e.each(a,function(e,n){o=i%2==0?":    ":t.EMPTY,a[e]=t.getMarkUp(n,o,t.EMPTY),i++}),n=a.join("\n")):n+="\n:    \n",n},footnote:function(n){var i,o,a,s="Enter footnote ",r=t.EMPTY;return n.indexOf("\n")<0?(r="[^1]: "+s+"1\n",n=t.getMarkUp(n,t.EMPTY,s+"[^1]")+"\n"+r):(i=1,a=n.split("\n"),e.each(a,function(e,n){o="[^"+i+"]",a[e]=t.getMarkUp(n,t.EMPTY,o+"  "),r=r+o+": "+s+i+"\n",i++}),n=a.join("\n")+"  \n\n"+r),n},blockquote:{before:"> ",after:"  "},code:{before:"`",after:"`",inline:!0},codeblock:function(e){return function(n){return t.isEmpty(n,!0)&&(n=t.EMPTY),t.getMarkUp(e,"~~~"+n+" \n","\n~~~  \n")}},hr:{before:t.EMPTY,after:"\n- - -",inline:!0}},exportConfig:{exportText:{ext:"txt",uri:"data:text/plain;base64,"},exportHtml:{ext:"htm",uri:"data:text/html;base64,"}}},(o=function(){this.init()}).prototype={constructor:o,init:function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1},execute:function(e){this._clearRedo(),e.execute(),this.commands.push(e),this.stackPosition++,this.changed()},undo:function(){this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()},canUndo:function(){return this.stackPosition>=0},redo:function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!==this.savePosition},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}},(a=function(e,t,n,i,o){this.textarea=e,this.oldValue=t,this.newValue=n,this.oldPos=i,this.newPos=o}).prototype={constructor:a,execute:function(){},undo:function(){var e=this.textarea,n=e[0];e.val(this.oldValue),t.setSelectionRange(n,this.oldPos[0],this.oldPos[1])},redo:function(){var e=this.textarea,n=e[0];e.val(this.newValue),t.setSelectionRange(n,this.newPos[0],this.newPos[1])}},(s=function(t,n){this.$element=e(t),this.init(n)}).prototype={constructor:s,init:function(n){var i=this,o=i.$element;e.each(n,function(e,t){i[e]=t}),i.initToolbar(),i.isDisabled=o.attr("disabled")||o.attr("readonly"),o.attr("id")||o.attr("id",t.uniqueId()),i.isBs4="4"===String(i.bsVersion).substring(0,1),void 0===i.exportPrependCssJs&&(i.exportPrependCssJs='<link href="https://maxcdn.bootstrapcdn.com/bootstrap/'+(i.isBs4?t.BS4_VER:t.BS3_VER)+'/css/bootstrap.min.css" rel="stylesheet">'),i.setDefaults("icons"),i.setDefaults("buttonTitles"),i.setDefaults("buttonLabels"),i.setDefaults("buttonPrompts"),i.setDefaults("buttonAccessKeys"),i.setDefaults("buttonActions"),i.setDefaults("buttonCss"),i.setDefaults("buttonGroupCss"),i.setDefaults("dropdownCss"),i.setDefaults("exportConfig"),i.setDefaults("templates"),i.defaultInputHeight=o.height(),i.enableSplitMode&&void 0===i.enableLivePreview&&(i.enableLivePreview=!0),i.render(),i.$preview.height(i.defaultInputHeight),o.height(i.defaultInputHeight),i.startFullScreen&&i.toggleFullScreen(),i.initLibrary(),i.reset(),i.listen()},getLibrary:function(){return this._library||null},initLibrary:function(){var n,i=this;window.markdownit?(n=i._library=window.markdownit(i.markdownItOptions),e.each(i.markdownItPlugins,function(e,t){window[e]&&n.use(window[e],t)}),t.isEmpty(i.markdownItDisabledRules)||n.disable(i.markdownItDisabledRules),t.isEmpty(i.parserUrl)&&void 0===i.parserMethod&&(i.parserMethod=function(e){return n.renderer.rules.emoji=function(e,t){return i.useTwemoji&&window.twemoji?window.twemoji.parse(e[t].content):'<span class="md-emoji">'+e[t].content+"</span>"},n.renderer.rules.paragraph_open=n.renderer.rules.heading_open=function(e,t,n,i,o){var a;return e[t].map&&0===e[t].level&&(a=e[t].map[0],e[t].attrJoin("class","md-line"),e[t].attrSet("data-line",String(a))),o.renderToken(e,t,n,i,o)},n.render(e)})):console&&"function"==typeof console.log&&console.log("INIT LIBRARY ERROR: Markdown IT Library not found or not loaded.")},setDefaults:function(t){"function"!=typeof this[t]&&(this[t]=e.extend(!0,{},i[t]||{},this[t]))},getConfig:function(t,n){var i,o=this[t],a=this.theme&&e.fn.markdownEditorThemes[this.theme]||{};return void 0===o?null:"function"==typeof(i=a[t])?i(n):"function"==typeof o?o(n):o[n]},handleEvent:function(n,i,o){var a=i+t.NAMESPACE;n.off(a).on(a,e.proxy(this[o],this))},listen:function(){var t=this.$container,i=this.$element,o=this.$preview,a=i.closest("form"),s=n.resize,r=n.reset,l=n.keyup,d=n.buttonPress,c=n.focus,u=n.blur,h=n.change,f=n.click,p=n.touchstart+" "+n.mouseover,m=this.$editor.find(".md-emoji-search"),g=n.keydown;this.parseButtons(),t.find(".dropdown-toggle").dropdown(),this.handleEvent(this.$dialog,g,"keydownDialog"),this.handleEvent(i,c,"focus"),this.handleEvent(o,c,"focus"),this.handleEvent(i,u,"blur"),this.handleEvent(o,u,"blur"),this.handleEvent(e(document),g,"escapeFullScreen"),this.handleEvent(e(window),s,"resizeWindow"),a.length&&this.handleEvent(a,r,"reset"),this.handleEvent(this.$btnUndo,f,"undo"),this.handleEvent(this.$btnRedo,f,"redo"),this.handleEvent(i,l,"keyup"),this.handleEvent(i,d,"buttonPress"),this.handleEvent(i,p,"mouseoverEditor"),this.handleEvent(o,p,"mouseoverPreview"),this.handleEvent(this.$modeInput,h,"changeMode"),m.length&&(this.handleEvent(m.find("input"),l,"emojiSearch"),this.handleEvent(m.find(".md-close"),f,"emojiSearchClose"))},resizeWindow:function(n){var i,o,a=this,s=a.$container,r=a.$preview;t.handler(n,function(){s.hasClass("md-fullscreen-overlay")&&a.resizeFullScreen(),(i=r.find(".md-preview-message")).length&&(o=e(window).width()<640?"100%":.5*r.width(),i.width(o))})},emojiSearch:function(n){var i=this.$editor.find(".md-emoji-search"),o=i.find("input").val(),a=i.closest("ul");t.handler(n,function(){t.delay(function(){a.find("li").each(function(){var t=e(this),n=t.find("a").attr("data-key");t.hasClass("md-emoji-search")||n&&-1!==n.indexOf(o)?t.show():t.hide()})})})},emojiSearchClose:function(e){var n=this.$editor.find(".md-emoji-search");t.handler(e,function(){e.stopPropagation(),n.closest("ul").find("li").show(),n.find("input").val("")})},focus:function(e){var n=this;t.handler(e,function(){t.addCss(n.$editor,"active")})},blur:function(e){var n=this;t.handler(e,function(){n.$editor.removeClass("active")})},clickButton:function(e,n){var i,o,a=this,s=n.data("key"),r=n.hasClass("md-btn-heading"),l=n.hasClass("md-btn-export"),d=n.hasClass("md-btn-emoji");t.handler(e,function(){if(a.isDisabled&&!a.isPreviewModeButton(s))return!1;if(r||l||d){if(e.preventDefault(),l&&a.raise("clickExport",[s]))return void a.exportData(s);if(d&&a.raise("clickEmoji",[s,":"+s+":"]))return void a.replaceSelected(":"+s+":")}switch(s){case"fullscreen":a.toggleFullScreen();break;case"hint":i=a.getTitle(s)+" <small>"+t.CREDITS+"</small>",a.showPopup(i,a.renderHint(),!0);break;default:o=a.process(s),a.raise("clickButton",[s,o])&&!t.isEmpty(o)&&a.replaceSelected(o)}})},changeMode:function(e){var n,i,o=this;t.handler(e,function(){n=o.$mode.find('input:radio[name="mdMode"]:checked').val()||"modeEditor",i=n.substr(4).toLowerCase(),o.raise("changeMode",[i])&&(o.toggleMode(n),o.currentMode=i)})},reset:function(e){var n=this,i=n.$element,o=i[0];t.handler(e,function(){setTimeout(function(){n.enableUndoRedo?(n.undoStack=n.resetUndoStack(),n.startValue=i.val(),n.startPos=[o.selectionStart,o.selectionEnd]):n.undoStack=null,n.$preview.is(":visible")&&setTimeout(function(){n.generatePreview()},1)},1)})},undo:function(e){var n=this;n.enableUndoRedo&&n.raise("undo",[n.undoStack])&&t.handler(e,function(){n.undoStack.undo(),n.scrollMap=null,n.enableLivePreview&&n.generatePreview()})},redo:function(e){var n=this;n.enableUndoRedo&&n.raise("undo",[n.undoStack])&&t.handler(e,function(){n.undoStack.redo(),n.scrollMap=null,n.enableLivePreview&&n.generatePreview()})},keyup:function(e){var n=this,i=n.$element,o=i[0],s=n.undoStack;t.handler(e,function(){n.enableLivePreview&&n.$preview.is(":visible")&&t.delay(n.generatePreview()),n.enableUndoRedo&&t.delay(function(){var e=i.val(),t=[o.selectionEnd,o.selectionEnd];e!==n.startValue&&(s.execute(new a(i,n.startValue,e,n.startPos,t)),n.startValue=e,n.startPos=t,n.scrollMap=null)})})},keydownDialog:function(n){var i=this;t.handler(n,function(){var t=e(n.target),o=t.hasClass("md-dialog-input"),a=t.hasClass("md-dialog-title");13===n.keyCode&&(o||a)&&(n.stopPropagation(),n.preventDefault(),!a&&i.$dialogTitle.is(":visible")||i.$dialogSubmit.trigger("click"))})},buttonPress:function(e,n,i){var o,s=this,r=s.$element;t.handler(e,function(){s.isDisabled||(s.enableUndoRedo&&(o=r.val(),s.startPos=n,s.undoStack.execute(new a(r,s.startValue,o,s.startPos,i)),s.startValue=o,s.startPos=i),s.enableLivePreview&&s.$preview.is(":visible")&&s.generatePreview())})},_mouseover:function(e,t){var i=this,o=i.$element,a=i.$preview,s=n.scroll;e&&e.isDefaultPrevented()||!o.is(":visible")||!a.is(":visible")||("editor"===t?(a.off(s),o.on(s,function(){i.syncPreviewScroll()})):(o.off(s),a.on(s,function(){i.syncInputScroll()})))},mouseoverEditor:function(e){var n=this;t.handler(e,function(){n._mouseover(e,"editor")})},mouseoverPreview:function(e){var n=this;t.handler(e,function(){n._mouseover(e,"preview")})},buildScrollMap:function(){var n,i,o,a,s,r,l,d=this.$element,c=this.$preview,u=0,h=[],f=[],p=[];if(!this.enableScrollSync)return"";for(l=t.create("div").css({position:"absolute",visibility:"hidden",height:"auto",width:d[0].clientWidth,"font-size":d.css("font-size"),"font-family":d.css("font-family"),"line-height":d.css("line-height"),"white-space":d.css("white-space")}).appendTo("body"),i=c[0].scrollTop-c.offset().top,d.val().split("\n").forEach(function(e){var t,n;h.push(u),0!==e.length?(l.text(e),t=parseFloat(l.css("height")),n=parseFloat(l.css("line-height")),u+=Math.round(t/n)):u++}),l.remove(),h.push(u),r=u,n=0;n<r;n++)p.push(-1);for(f.push(0),p[0]=0,c.find(".md-line").each(function(t,n){var o=e(n),a=o.data("line");""!==a&&(0!==(a=h[a])&&f.push(a),p[a]=Math.round(o.offset().top+i))}),f.push(r),p[r]=c[0].scrollHeight,o=0,n=1;n<r;n++)-1===p[n]?(a=f[o],s=f[o+1],p[n]=Math.round((p[s]*(n-a)+p[a]*(s-n))/(s-a))):o++;return p},syncInputScroll:function(){var e,t,n,i=this.$element,o=this.$preview,a=this.scrollMap,s=o[0].scrollTop,r=parseFloat(i.css("line-height"));if(a||(a=this.scrollMap=this.buildScrollMap()),!((e=Object.keys(a)).length<1)){for(n=e[0],t=1;t<e.length&&a[e[t]]<s;t++)n=e[t];i.stop(!0).animate({scrollTop:r*n},100,"linear")}},syncPreviewScroll:function(){var e,t=this.$element,n=this.$preview,i=this.scrollMap,o=parseFloat(t.css("line-height")),a=Math.floor(t[0].scrollTop/o);i||(i=this.scrollMap=this.buildScrollMap()),e=i[a],n.stop(!0).animate({scrollTop:e},100,"linear")},isPreviewModeButton:function(e){return-1!==this.previewModeButtons.indexOf(e)},resetUndoStack:function(){var e=this,t=new o;return e.startValue=e.$element.val(),e.startPos=[0,0],t.changed=function(){e.disableButton(e.$btnUndo,!t.canUndo()),e.disableButton(e.$btnRedo,!t.canRedo())},t.changed(),t},parseButtons:function(){var t=this,i=t.$container,o=n.click;i.find(".md-btn,.md-btn-heading,.md-btn-export,.md-btn-emoji").each(function(){var n=e(this);n.off(o).on(o,function(e){t.clickButton(e,n)})})},getSelected:function(){var e=this.$element,t=e.val(),n=e[0];return t.substring(n.selectionStart,n.selectionEnd)},replaceSelected:function(e){var i=this.$element,o=i.val(),a=i[0],s=a.selectionStart,r=e.length,l=a.selectionEnd,d=o.substring(0,s)+e+o.substring(l),c=s+r;i.val(d).trigger(n.buttonPress,[[s,l],[s,c]]),t.setSelectionRange(a,s,c)},destroy:function(){var n=this.$element,i=this.$container,o=this.inputCss,a=t.NAMESPACE;o&&n.removeClass(o).show(),n.off(a),e(window).off(a),e(document).off(a),i.before(n).remove()},getLayout:function(e){var n,i,o,a,s=this.getConfig("templates",e)||t.EMPTY;return"dialog"===e&&(i="<"+(a=this.isBs4?"h5":"h4")+' class="md-dialog-head-title modal-title"></'+a+">",o=this.getConfig("templates","dialogClose"),n=this.isBs4?i+"\n"+o:o+"\n"+i,s=s.replace("{HEADER}",n).replace("{DIALOG_CANCEL_ICON}",this.renderIcon("dialogCancel")).replace("{DIALOG_SUBMIT_ICON}",this.renderIcon("dialogSubmit")).replace("{DIALOG_CANCEL_TEXT}",this.dialogCancelText).replace("{DIALOG_SUBMIT_TEXT}",this.dialogSubmitText)),s},submitExportForm:function(n,i){var o,a,s,r=t.create("form"),l=this.$element.attr("id")+"-iframe",d=this.exportUrlAddlData;e("#"+l).length||t.create("iframe",{id:l,name:l,css:{display:"none"}}).appendTo("body"),o=t.create("input",{type:"hidden",name:"export_type",value:n}),a=t.create("input",{type:"hidden",name:"export_filename",value:this.exportFileName}),s=t.create("input",{name:"export_content",css:{display:"none"}}).val(i||this.noDataMsg),r.attr({target:l,action:this.exportUrl,method:this.exportUrlMethod}),r.append(o,a,s),d&&r.append("function"==typeof d?d():d),r.appendTo("body").hide().submit().remove()},showPopup:function(e,t,i){var o=this,a=n.modalShown;o.$dialogMain.removeClass("modal-lg"),i&&o.$dialogMain.addClass("modal-lg"),o.$dialogHeadTitle.html(e),o.$dialogContent.html(t).show(),o.$dialogInput.hide(),o.$dialogTitle.hide(),o.$dialogClose.show(),o.$dialogHeader.show(),o.$dialogFooter.hide(),o.$dialogSubmit.off(n.click),o.$dialog.modal("show"),o.$dialog.off(a).on(a,function(){o.$dialogClose.focus(),o.$dialog.off(a)})},showDialog:function(e,i,o){var a=this,s=a.getConfig("buttonPrompts",e),r=s.header||t.EMPTY,l=a.renderIcon(e),d=s.hintInput||t.EMPTY,c=s.hintTitle,u=n.modalShown,h=n.click;a.$dialogMain.removeClass("modal-lg"),a.$dialogHeadTitle.html(l?l+" "+r:r),a.$dialogContent.hide(),a.$dialogTitle.hide().val(o||t.EMPTY),a.$dialogClose.show(),a.$dialogHeader.show(),a.$dialogFooter.show(),a.$dialogInput.show().val(t.EMPTY).attr("placeholder",d),c&&!o&&a.$dialogTitle.show().attr("placeholder",c),a.$dialogSubmit.off(h).on(h,function(){var e=i(a.$dialogInput.val(),a.$dialogTitle.val());t.isEmpty(e)||a.replaceSelected(e)}),a.$dialog.modal("show"),a.$dialog.off(u).on(u,function(){a.$dialogInput.focus(),a.$dialog.off(u)})},raise:function(n,i,o){var a=e.Event(n+t.NAMESPACE);return o=o||this.$element,i?o.trigger(a,i):o.trigger(a),!a.isDefaultPrevented()||!1===a.result},showPreviewMsg:function(e){var t=this.$preview,n=this.getAlert(e,this.previewErrorTitle);t.html('<div class="md-preview-message">'+n+"</div>"),t.find(".md-preview-message").width(.5*t.width()),t.find(".md-alert").hide().fadeIn("slow")},disableButton:function(e,t){t?e.attr("disabled",!0):e.removeAttr("disabled")},hasInvalidConfig:function(e){var n=this[e+"Url"],i=this["export"===e?"exportUrlMethod":e+"Method"],o=t.isEmpty(n),a=t.isEmpty(i),s=typeof i;return o&&a||!a&&"function"!==s&&"object"!==s},parseOutput:function(t){var n=this.postProcess;return n&&("function"==typeof n?t=n(t):"object"==typeof n&&e.each(n,function(e,n){e!==n&&(t=t.split(e).join(n))})),t},getPureHtml:function(e){return this.purifyHtml&&window.DOMPurify?window.DOMPurify.sanitize(e):e},getHtml:function(e){var n=this.$element,i=this.parserMethod;return void 0===e&&(e=n.val()),t.isEmpty(this.parserUrl)?(e="function"==typeof i?i(e):new i(e),e=this.parseOutput(e),this.getPureHtml(e)):(this._ajaxSubmit(e),null)},generatePreview:function(e,t){var n=this.getHtml(e);if(t)return n;this.$preview.html(n)},output:function(){var e,i=this.$element,o=this.$preview,a=i.val(),s=!0,r=0,l=n.successPreview,d=n.emptyPreview+" "+n.errorPreview;if(t.isEmpty(a)||this.hasInvalidConfig("parser"))return t.EMPTY;if(e=this.generatePreview(a,!0),t.isEmpty(this.parserUrl))return e;for(;s&&r<this.outputParseTimeout;)t.delay(function(){i.off(l).on(l,function(){s=!1,e=o.html()}).off(d).on(d,function(){s=!1,e=""}),r+=150},150);return e},toggleMode:function(e){var n,i=this,o=i.$element.val(),a=i.$container,s=i.currentMode||"modeEditor",r=a.find(".md-input-preview"),l=function(){"editor"===s&&(i.$preview.html(i.getProgress(i.loadingMsg)),setTimeout(function(){i.generatePreview(),i.$mode.focus()},50))};switch((t.isEmpty(o)||i.hasInvalidConfig("parser"))&&(n=t.isEmpty(o)?i.noDataMsg:i.noPreviewUrlMsg,i.showPopupAlert(i.getTitle("mode"),n,"errorToggleMode",[i.$modeInput.val()])),a.removeClass("md-only-preview"),r.removeClass("md-editor-mode md-preview-mode md-split-mode"),e){case"modeEditor":t.addCss(r,"md-editor-mode");break;case"modePreview":t.addCss(r,"md-preview-mode"),t.addCss(a,"md-only-preview"),l();break;case"modeSplit":t.addCss(r,"md-split-mode"),l()}},toggleFullScreen:function(){var e=this.$container,t=this.$element,n=this.$preview;e.hasClass("md-fullscreen-overlay")?this.raise("normalScreen")&&(e.removeClass("md-fullscreen-overlay"),t.height(this.defaultInputHeight),n.height(this.defaultInputHeight)):this.raise("fullScreen")&&(e.addClass("md-fullscreen-overlay"),this.resizeFullScreen()),n.is(":visible")?n.focus():t.focus()},escapeFullScreen:function(e){this.enableEscKeyFullScreen&&this.$container.hasClass("md-fullscreen-overlay")&&27==e.keyCode&&this.toggleFullScreen()},resizeFullScreen:function(){var t=this.$container,n=this.$element,i=t.find(".md-header"),o=t.find(".md-footer"),a=e(window).height()-i.outerHeight(!0)-o.outerHeight(!0)-(n.outerHeight(!0)-n.height());n.height(a),this.$preview.height(a)},process:function(e){var n,i,o,a,s,r=this.$element,l=this.getSelected(),d=l.length,c=this.getConfig("buttonActions",e);return"mode"!==e&&"export"!==e.substring(0,6)&&r.focus(),"undo"===e||"redo"===e?"":c?"function"==typeof c?"function"==typeof(n=c(l))?(this.showDialog(e,n,l),t.EMPTY):n:"object"!=typeof c||void 0===c.before&&void 0===c.after?t.EMPTY:(o=t.isEmpty(c.before)?t.EMPTY:c.before,a=t.isEmpty(c.after)?t.EMPTY:c.after,i=c.default,s=c.skipSpaces,n=c.inline?t.getMarkUp(l,o,a,s):t.getBlockMarkUp(l,o,a,s),i?d>0?n:i:n):t.EMPTY},download:function(e,n){var i,o=this.getConfig("exportConfig",e),a=o.ext||"",s=o.uri||"";t.isEmpty(this.exportUrl)?(s+=window.btoa(n),(i=t.create("a",{href:s,download:this.getFileName(e)}).appendTo("body"))[0].click(),i.remove()):this.submitExportForm(a,n)},getLabel:function(e){return this.renderIcon(e)+" "+(this.getConfig("buttonLabels",e)||t.EMPTY)},getTitle:function(e){return this.renderIcon(e)+" "+(this.getConfig("buttonTitles",e)||t.EMPTY)},getProgress:function(e){return'<div class="md-loading">'+e+"</div>"},getAlert:function(e,t,n){return t=t?"<h4>"+(n?"":this.renderIcon("alertMsg"))+t+"</h4>":"",'<div class="'+this.alertMsgCss+' md-alert">'+t+e+"</div>"},showPopupAlert:function(e,t,i,o){var a=this,s=a.$dialog.find(".modal-body"),r=a.alertFadeDuration,l=n.modalShown,d=n.modalHidden;a.showAlerts&&(a.showPopup("",a.getAlert(t,e,!0)),a.$dialogHeader.hide(),a.$dialogFooter.hide(),a.$dialogClose.hide(),s.addClass("md-zero-pad"),a.$dialog.off(l).on(l,function(){r?setTimeout(function(){a.$dialog.modal("hide").off(l)},r):a.$dialog.modal("hide").off(l)}),a.$dialog.off(d).on(d,function(){s.removeClass("md-zero-pad"),a.$dialog.off(l).off(d),a.$element.focus()})),i&&((o=o||[]).push(e),o.push(t),a.raise(i,o))},getHtmlContent:function(e){var t=this.exportPrependCssJs;return"<html>\n<head>\n"+this.getLayout("htmlMeta")+this.getLayout("exportCssJs").replace("{EXPORT_PREPEND_CSS_JS}",t)+"\n</head>\n<body>\n"+e+"\n</body>\n</html>"},exportData:function(e){var n,i,o,a=this.$element.val(),s=this.getTitle("exportText"),r=this.getTitle("exportHtml"),l=this.noDataMsg,d=this.noExportUrlMsg,c=this.today||new Date;if(t.isEmpty(a)||!t.isEmpty(this.exportUrl)&&this.hasInvalidConfig("export"))return i="exportText"===e?s:r,o=t.isEmpty(a)?l:d,void this.showPopupAlert(i,o,"errorExport",[e]);a=this.getLayout("exportHeader").replace("{TODAY}",c).replace("{CREDITS}",t.CREDITS_MD)+a,"exportHtml"===e?(n=t.parseHtml(this.generatePreview(a,!0)),this.download("exportHtml",this.getHtmlContent(n))):this.download("exportText",a)},renderIcon:function(e){return this.getConfig("icons",e)||t.EMPTY},render:function(){var n,i=this.$element,o=t.create("div").addClass("md-container"),a=this.getLayout("main"),s="md-editor-input-temporary",r=i.attr("id")+"-container";if(!a)return t.EMPTY;this.theme&&t.addCss(o,"theme-"+this.theme),n=a.replace("{INPUT}",'<div class="'+s+'"></div>').replace("{HEADER}",this.renderHeader()).replace("{FOOTER}",this.renderFooter()).replace("{PREVIEW}",this.getLayout("preview")).replace("{DIALOG}",this.getLayout("dialog")),o.attr("id",r).insertBefore(i).html(n),o.find("."+s).before(i).remove(),t.addCss(i,this.inputCss),this.$container=o,this.$editor=o.find(".md-editor"),this.$preview=o.find(".md-preview"),this.$btnPreview=o.find(".md-btn-preview"),this.$btnUndo=o.find(".md-btn-undo"),this.$btnRedo=o.find(".md-btn-redo"),this.$dialog=o.find(".md-dialog"),this.$dialogHeadTitle=this.$dialog.find(".md-dialog-head-title"),this.$dialogInput=this.$dialog.find(".md-dialog-input"),this.$dialogTitle=this.$dialog.find(".md-dialog-title"),this.$dialogContent=this.$dialog.find(".md-dialog-content"),this.$dialogCancel=this.$dialog.find(".md-dialog-cancel"),this.$dialogSubmit=this.$dialog.find(".md-dialog-submit"),this.$dialogClose=this.$dialog.find(".close"),this.$dialogMain=this.$dialog.find(".modal-dialog"),this.$dialogHeader=this.$dialog.find(".modal-header"),this.$dialogFooter=this.$dialog.find(".modal-footer"),this.$mode=o.find(".md-btn-mode"),this.$modeInput=this.$mode.find('input:radio[name="mdMode"]'),this.$inputPreview=o.find(".md-input-preview"),this.$inputCell=o.find(".md-input-cell"),this.$previewCell=o.find(".md-preview-cell"),this.previewModeTitle&&this.$editor.find(".md-toolbar-header-l").prepend('<div class="md-preview-mode-title">'+this.previewModeTitle+"</div>"),"preview"===this.defaultMode||this.enableSplitMode&&"split"===this.defaultMode||(this.defaultMode="editor"),this.currentMode=this.defaultMode,t.addCss(this.$inputPreview,"md-"+this.defaultMode+"-mode"),e.each(this.dropUp,function(e,t){t&&o.find('button[data-key="'+e+'"]').parent().addClass("dropup")})},initToolbar:function(){var t=this;e.each(["toolbarHeaderL","toolbarHeaderR","toolbarFooterL","toolbarFooterR"],function(n,o){void 0!==t[o]&&e.isArray(t[o])||(t[o]=i.toolbar[o])})},getButtons:function(t){var n=[];return e.each(this[t],function(t,i){var o=e.isArray(i)?i:[i];e.merge(n,o)}),n},getValidButtons:function(){var t=this.getButtons("toolbarHeaderL");return e.merge(t,this.getButtons("toolbarHeaderR")),e.merge(t,this.getButtons("toolbarFooterL")),e.merge(t,this.getButtons("toolbarFooterR")),t},renderHint:function(){var n,i,o,a,s,r,l=this,d="{ACCESS_KEYS}";return-1===(n=l.getLayout("hint").replace("{LINK_CM}",t.LINK_CM).replace("{LINK_MI}",t.LINK_MI)).indexOf(d)?n:(i='<div class="md-hint-access-keys"><ul>',e.each(l.getValidButtons(),function(e,t){var n;if(r=l.getConfig("buttonCss",t)||l.defaultButtonCss,"heading"===t)for(s=1;s<=6;s++)o=l.renderIcon("heading")+s,n=l.getConfig("buttonAccessKeys",t+s),a=l.getConfig("buttonTitles","heading")+" "+s,i+='<li title="'+a+'"><p><span class="'+r+'">'+o+"</span></p><p><kbd>ALT</kbd> &ndash; <kbd>"+n+"</kbd></p></li>";else"export"!==t.substring(0,6)&&"mode"!==t.substring(0,4)&&(n=l.getConfig("buttonAccessKeys",t),o=l.renderIcon(t),a=l.getConfig("buttonTitles",t),i+='<li title="'+a+'"><p><span class="'+r+'">'+o+"</span></p><p><kbd>ALT</kbd> &ndash; <kbd>"+n+"</kbd></p></li>")}),i+="</ul></div>",n.replace(d,i))},renderHeader:function(){var e=this.getLayout("header");return e=this.renderToolbar(e,"toolbarHeaderL"),e=this.renderToolbar(e,"toolbarHeaderR")},renderFooter:function(){var e=this.getLayout("footer");return e=this.renderToolbar(e,"toolbarFooterL"),e=this.renderToolbar(e,"toolbarFooterR")},renderToolbar:function(t,n){var i,o,a,s=this,r=n.toUpperCase(),l="",d="";return i="{"+r.substring(0,7)+"_"+r.substring(7,13)+"_"+r.substring(13,14)+"}",-1===t.indexOf(i)?t:(e.each(s[n],function(t,n){e.isArray(n)||(n=[n]),a="",e.each(n,function(e,t){o=s.getConfig("buttonGroupCss",t)||s.defaultButtonGroupCss,a+=s.renderButton(t)+"\n",s.isPreviewModeButton(t)&&(o+=" md-always-visible"),"mode"===t&&(o+=" btn-group-toggle md-btn-mode",d=' data-toggle="buttons"')}),l+='<div class="'+o+'" role="group"'+d+">\n"+a+"</div>\n"}),t.replace(i,l))},getFileName:function(e){var t=this.exportFileName,n=this.getConfig("exportConfig",e),i=n&&n.ext||"";return i?t+"."+i:t},renderMenuItem:function(e,n){var i,o,a,s=t.create("div"),r=e+n;return"export"===e?(o=this.getConfig("buttonTitles",r),a=this.getLabel(r)):a=(o=this.getConfig("buttonTitles",e))+" "+n,i=t.create("a",{href:"#",class:"dropdown-item md-btn-"+e+" md-btn-"+r,title:o,accesskey:this.getConfig("buttonAccessKeys",r),"data-key":r}).html(a),a=s.append(i).html(),s.remove(),this.isBs4?a:"<li>"+a+"</li>"},getEmojies:function(){var n=this,i="";return!n.enableEmojies||t.isEmpty(window.mdEmojies)?"":(i='<li class="md-emoji-search"><span class="md-close">&times;</span><input type="text" class="form-control form-control-sm input-sm" placeholder="'+n.emojiSearchHint+'"></li>',e.each(window.mdEmojies,function(e,o){var a,s,r=":"+t.htmlEncode(e)+":",l=window.mdEmojiesShortcuts[e]||"";if(l)for(r+=" or ",a=0;a<l.length;a++)s=t.htmlEncode(l[a]),r+=0===a?s:" or "+s;i+='<li><a href="#" class="md-btn-emoji" title="'+r+'" data-key="'+e+'"><span class="md-emoji">'+(n.useTwemoji?window.twemoji.parse(o):o)+"</span></a></li>"}),i)},getModeButton:function(e){var t=this.getConfig("buttonCss",e)||this.defaultButtonCss||"",n="",i=e.substr(4).toLowerCase(),o=this.getConfig("buttonAccessKeys",e)||"";return this.defaultMode===i&&(t+=" active",n=" checked"),'<label class="'+t+'" title="'+this.getConfig("buttonTitles",e)+'"><input type="radio" value="'+e+'" name="mdMode" autocomplete="off" accesskey="'+o+'"'+n+">"+this.renderIcon(e)+"</label>"},renderButton:function(e){var n,i,o,a,s,r,l,d=this.getConfig("icons",e),c="md-btn-"+e,u=this.getConfig("dropdownCss",e),h="mode"===e||void 0!==d||void 0!==this.getConfig("buttonActions",e),f=this.isBs4&&"emoji"!==e?"div":"ul";if(!h||!this.enableUndoRedo&&("undo"===e||"redo"===e||"editor"===e))return t.EMPTY;switch(l=this.getConfig("buttonCss",e)||this.defaultButtonCss,i=t.create("div"),n=t.create("button",{type:"button","data-key":e}),this.disableButton(n,this.isDisabled&&!this.isPreviewModeButton(e)),d=this.renderIcon(e),o=this.getConfig("buttonTitles",e)||t.EMPTY,a=this.getConfig("buttonLabels",e)||t.EMPTY,o&&n.attr("title",o),"fullscreen"===e&&(d='<span class="md-max-icon">'+d+'</span><span class="md-min-icon">'+this.renderIcon("minscreen")+"</span>"),a=d&&a?d+" "+a:d+a,i.append(n),e){case"emoji":case"export":case"heading":if(n.html(a+" ").attr({"data-toggle":"dropdown"}).append('<span class="caret"></span>').addClass(l+" dropdown-toggle"),r="<"+f+' class="'+(u?"dropdown-menu "+u:"dropdown-menu")+'">\n',"heading"===e)for(s=1;s<7;s++)o+" "+s,r+=this.renderMenuItem("heading",s);else r+="emoji"===e?this.getEmojies():this.renderMenuItem(e,"Html")+this.renderMenuItem(e,"Text");return r+="</"+f+">",i.append(r),i.html();case"mode":return this.getModeButton("modeEditor")+this.getModeButton("modePreview")+(this.enableSplitMode?this.getModeButton("modeSplit"):"");default:return n.attr("accesskey",this.getConfig("buttonAccessKeys",e)).html(a).addClass(l+" "+c+" md-btn"),i.html()}},_mergeAjaxCallback:function(e,t){var n=this._ajaxSettings,i=this.mergeAjaxCallbacks,o=n[e];n[e]=i&&"function"==typeof o?"before"===i?function(){o.apply(this,arguments),t.apply(this,arguments)}:function(){t.apply(this,arguments),o.apply(this,arguments)}:t},_ajaxSubmit:function(t){var n,i,o,a,s,r=this,l=r.ajaxParserErrorMsg,d=r.getTitle("exportHtml");n=function(e){r.raise("beforeExportHtm",[e])&&r.showPopup(d,r.getProgress(r.ajaxParserProgressMsg))},i=function(e,t,n){r.$dialog.modal("hide"),e?(s=r.getPureHtml(e),r.download("exportHtml",r.getHtmlContent(s)),r.raise("successExportHtm",[e,t,n])):r.showPopupAlert(d,l,"errorExportHtm",[e,t,n])},o=function(e,t,n){r.showPopupAlert(d,l,"exceptionExportHtm",[e,t,n])},r._ajaxSettings=e.extend(!0,{},r.ajaxSettings),r._mergeAjaxCallback("beforeSend",n),r._mergeAjaxCallback("success",i),r._mergeAjaxCallback("error",o),a=e.extend(!0,{},{type:"POST",url:r.parserUrl,data:{source:t}},r._ajaxSettings),e.ajax(a)}},e.fn.markdownEditor=function(n){var i=Array.apply(null,arguments),o=[];switch(i.shift(),this.each(function(){var a,r=e(this),l=r.data("markdownEditor"),d="object"==typeof n&&n,c=d.theme||r.data("theme"),u={},h={},f=d.language||r.data("language")||e.fn.markdownEditor.defaults.language||"en";l||(c&&(h=e.fn.markdownEditorThemes[c]||{}),"en"===f||t.isEmpty(e.fn.markdownEditorLocales[f])||(u=e.fn.markdownEditorLocales[f]||{}),a=e.extend(!0,{},e.fn.markdownEditor.defaults,h,e.fn.markdownEditorLocales.en,u,d,r.data()),l=new s(this,a),r.data("markdownEditor",l)),"string"==typeof n&&o.push(l[n].apply(l,i))}),o.length){case 0:return this;case 1:return o[0];default:return o}},e.fn.markdownEditor.defaults={language:"en",theme:null,bsVersion:t.BS4_VER,defaultMode:"editor",enableUndoRedo:!0,enableSplitMode:!0,enableLivePreview:void 0,enableScrollSync:!0,startFullScreen:!1,enableEmojies:!0,useTwemoji:!1,purifyHtml:!0,showAlerts:!0,enableEscKeyFullScreen:!0,toolbarHeaderL:void 0,toolbarHeaderR:void 0,toolbarFooterL:void 0,toolbarFooterR:void 0,exportPrependCssJs:void 0,dropUp:{export:!0},parserUrl:t.EMPTY,parserMethod:void 0,ajaxSettings:{},ajaxMergeCallbacks:!0,markdownItOptions:{html:!1,xhtmlOut:!0,breaks:!0,linkify:!0,typographer:!0,highlight:function(e){return window.hljs?window.hljs.highlightAuto(e).value:e}},markdownItDisabledRules:[],markdownItPlugins:{markdownitDeflist:{},markdownitFootnote:{},markdownitAbbr:{},markdownitEmoji:{},markdownitSub:{},markdownitSup:{},markdownitMark:{},markdownitIns:{},markdownitSmartArrows:{},markdownitCheckbox:{divWrap:!0,divClass:"form-check checkbox",idPrefix:"cbx_"},markdownitCjkBreaks:{}},exportUrl:t.EMPTY,exportUrlMethod:"post",exportUrlAddlData:t.EMPTY,today:t.EMPTY,alertFadeDuration:2e3,outputParseTimeout:18e5,exportConfig:i.exportConfig,templates:{},inputCss:"md-input",alertMsgCss:"alert alert-danger",defaultButtonCss:"btn btn-default btn-outline-secondary",defaultButtonGroupCss:"btn-group md-btn-group",previewModeButtons:["hint","fullscreen","mode","export"],buttonCss:{},buttonGroupCss:{},buttonAccessKeys:{},dropdownCss:{},icons:{},postProcess:{"<table>":'<table class="table table-bordered table-striped">',"<pre>":'<pre class="md-codeblock">',"<blockquote>":'<blockquote class="blockquote md-blockquote">','<input type="checkbox"':'<input type="checkbox" class="form-check-input"','<label for="cbx':'<label class="form-check-label" for="cbx'}},e.fn.markdownEditorLocales.en={ajaxParserErrorMsg:"Error parsing markdown text. Please try again later.",ajaxParserProgressMsg:"Parsing markdown text ...",noDataMsg:"No valid source data found!",exportFileName:"export",buttonTitles:{},buttonLabels:{},buttonPrompts:{},buttonActions:{},templates:{},dialogCancelText:"Cancel",dialogSubmitText:"Submit",previewErrorTitle:"Preview Error",previewModeTitle:"Preview Mode",previewProgressMsg:"Generating preview ...",noPreviewUrlMsg:"Markdown preview processor unavailable. Please contact the system administrator.",noExportUrlMsg:"Export processor unavailable. Please contact the system administrator.",emojiSearchHint:"Search emojis ...",loadingMsg:"Loading ..."},e.fn.markdownEditor.Constructor=s,e(document).ready(function(){var t=e("textarea.markdown");t.length&&t.markdownEditor()})});